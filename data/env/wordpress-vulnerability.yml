cve: CVE-2017-5487
attack_vector: remote

construction:
  os:
    name: centos
    version: 7.5
    default_method: yum

  user:
    - mysql

  vul_software:
    name: wordpress
    version: 4.7.1
    method: source
    document_root: /opt/httpd/htdocs
    wordpress_database: wordpressdb
    wordpress_user: wordpressuser
    wordpress_password: "ik42xa2Kt*DL"

  related_software:
    - name: gcc
    - name: apr
      version: 1.7.0
      method: source
      configure_options:
        prefix: /opt/apr

    - name: expat-devel
    - name: apr-util
      version: 1.6.1
      method: source
      configure_options:
        prefix: /opt/apr-util
        with-apr: /opt/apr

    - name: gcc-c++
    - name: perl
    - name: pcre
      version: 8.39
      method: source
      configure_options:
        prefix: /opt/pcre

    - name: httpd
      version: 2.4.43
      method: source
      configure_options:
        prefix: /opt/httpd
        with-pcre: /opt/pcre
        with-apr: /opt/apr
        with-apr-util: /opt/apr-util
        enable-so: ""

    - name: mysql
      version: 5.7.15
      user: mysql
      base_dir: /usr/local/mysql
      data_dir: /usr/local/mysql/data
      root_password: "K|6t|P.&GxAM"

    - name: libxml2-devel
    - name: libpng-devel
    - name: unzip
    - name: php
      version: 7.1.0
      method: source
      configure_options:
        enable-mbstring: ""
        with-gd: ""
        with-mysqli: mysqlnd
        with-apxs2: /opt/httpd/bin/apxs
        with-zlib: ""

    - name: wp-cli
      version: 0.24.1
      method: source

  content: content/CVE-2017-5487/wordpress_standard
